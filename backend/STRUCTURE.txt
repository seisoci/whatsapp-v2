backend/
â”‚
â”œâ”€â”€ ğŸ“„ Documentation Files
â”‚   â”œâ”€â”€ README.md                        # Main documentation & API reference
â”‚   â”œâ”€â”€ QUICKSTART.md                    # 5-minute setup guide
â”‚   â”œâ”€â”€ SECURITY.md                      # Security best practices
â”‚   â”œâ”€â”€ REFACTORING_SUMMARY.md           # Middleware refactoring details
â”‚   â”œâ”€â”€ PROJECT_SUMMARY.md               # Complete project overview
â”‚   â””â”€â”€ STRUCTURE.txt                    # This file - visual structure
â”‚
â”œâ”€â”€ âš™ï¸ Configuration Files
â”‚   â”œâ”€â”€ package.json                     # Dependencies & npm scripts
â”‚   â”œâ”€â”€ tsconfig.json                    # TypeScript configuration
â”‚   â”œâ”€â”€ .env                             # Environment variables (gitignored)
â”‚   â”œâ”€â”€ .env.example                     # Environment template
â”‚   â””â”€â”€ .gitignore                       # Git ignore rules
â”‚
â””â”€â”€ ğŸ“‚ src/                              # Source code directory
    â”‚
    â”œâ”€â”€ ğŸ”§ config/                       # Application configuration
    â”‚   â”œâ”€â”€ database.ts                  # TypeORM DataSource & connection
    â”‚   â””â”€â”€ env.ts                       # Environment variable validation (Zod)
    â”‚
    â”œâ”€â”€ ğŸ® controllers/                  # Business logic handlers
    â”‚   â””â”€â”€ auth.controller.ts           # Authentication controller
    â”‚       â”œâ”€â”€ register()               # User registration handler
    â”‚       â”œâ”€â”€ login()                  # User login handler
    â”‚       â”œâ”€â”€ refreshToken()           # Token refresh handler
    â”‚       â”œâ”€â”€ logout()                 # Logout & token revocation
    â”‚       â””â”€â”€ me()                     # Get current user handler
    â”‚
    â”œâ”€â”€ ğŸ›¡ï¸ middlewares/                  # HTTP middlewares
    â”‚   â”œâ”€â”€ README.md                    # Middleware documentation
    â”‚   â”œâ”€â”€ index.ts                     # Central export point
    â”‚   â”‚
    â”‚   â”œâ”€â”€ auth.middleware.ts           # JWT Authentication
    â”‚   â”‚   â””â”€â”€ authMiddleware()         # Verify JWT & protect routes
    â”‚   â”‚
    â”‚   â”œâ”€â”€ rateLimiter.middleware.ts    # Rate Limiting
    â”‚   â”‚   â”œâ”€â”€ rateLimiter()            # IP-based rate limiter
    â”‚   â”‚   â””â”€â”€ cleanupRateLimitMap()    # Cleanup expired entries
    â”‚   â”‚
    â”‚   â”œâ”€â”€ securityHeaders.middleware.ts # Security Headers
    â”‚   â”‚   â””â”€â”€ securityHeaders()        # Add CSP, HSTS, X-Frame-Options, etc
    â”‚   â”‚
    â”‚   â”œâ”€â”€ cors.middleware.ts           # CORS Protection
    â”‚   â”‚   â””â”€â”€ corsMiddleware()         # Whitelist-based CORS
    â”‚   â”‚
    â”‚   â”œâ”€â”€ sanitize.middleware.ts       # Input Sanitization
    â”‚   â”‚   â”œâ”€â”€ sanitizeMiddleware()     # Auto sanitize POST/PUT/PATCH
    â”‚   â”‚   â””â”€â”€ sanitizeInput()          # Manual sanitization function
    â”‚   â”‚
    â”‚   â””â”€â”€ ipFilter.middleware.ts       # IP Filtering
    â”‚       â”œâ”€â”€ ipFilter()               # Block/allow IPs
    â”‚       â”œâ”€â”€ getClientIP()            # Get client IP from headers
    â”‚       â”œâ”€â”€ addToBlacklist()         # Add IP to blacklist
    â”‚       â”œâ”€â”€ removeFromBlacklist()    # Remove IP from blacklist
    â”‚       â”œâ”€â”€ addToWhitelist()         # Add IP to whitelist
    â”‚       â”œâ”€â”€ removeFromWhitelist()    # Remove IP from whitelist
    â”‚       â”œâ”€â”€ isBlacklisted()          # Check if IP is blacklisted
    â”‚       â””â”€â”€ isWhitelisted()          # Check if IP is whitelisted
    â”‚
    â”œâ”€â”€ ğŸ“Š migrations/                   # Database migrations (TypeORM)
    â”‚   â”œâ”€â”€ 1704000000000-CreateUserTable.ts
    â”‚   â”‚   â””â”€â”€ Creates users table with indexes
    â”‚   â”‚
    â”‚   â””â”€â”€ 1704000000001-CreateRefreshTokenTable.ts
    â”‚       â””â”€â”€ Creates refresh_tokens table with FK
    â”‚
    â”œâ”€â”€ ğŸ—ƒï¸ models/                       # Database entities (TypeORM)
    â”‚   â”œâ”€â”€ User.ts                      # User entity
    â”‚   â”‚   â”œâ”€â”€ Fields: id, email, username, password, isActive, etc
    â”‚   â”‚   â”œâ”€â”€ hashPassword()           # Auto hash before save
    â”‚   â”‚   â”œâ”€â”€ comparePassword()        # Verify password
    â”‚   â”‚   â”œâ”€â”€ incrementLoginAttempts() # Track failed logins
    â”‚   â”‚   â”œâ”€â”€ resetLoginAttempts()     # Reset after success
    â”‚   â”‚   â”œâ”€â”€ isLocked()               # Check if account locked
    â”‚   â”‚   â””â”€â”€ toJSON()                 # Remove sensitive data
    â”‚   â”‚
    â”‚   â””â”€â”€ RefreshToken.ts              # Refresh token entity
    â”‚       â”œâ”€â”€ Fields: id, userId, token, expiresAt, etc
    â”‚       â”œâ”€â”€ isExpired()              # Check if token expired
    â”‚       â””â”€â”€ isValid()                # Check if token valid
    â”‚
    â”œâ”€â”€ ğŸ›£ï¸ routes/                       # API routes definition
    â”‚   â””â”€â”€ auth.routes.ts               # Authentication routes
    â”‚       â”œâ”€â”€ POST /register           # Register endpoint
    â”‚       â”œâ”€â”€ POST /login              # Login endpoint
    â”‚       â”œâ”€â”€ POST /refresh-token      # Refresh token endpoint
    â”‚       â”œâ”€â”€ POST /logout             # Logout endpoint
    â”‚       â””â”€â”€ GET /me (protected)      # Get current user endpoint
    â”‚
    â”œâ”€â”€ ğŸ“ types/                        # TypeScript type definitions
    â”‚   â””â”€â”€ index.ts                     # Shared interfaces & types
    â”‚       â”œâ”€â”€ JWTPayload              # Access token payload
    â”‚       â”œâ”€â”€ RefreshTokenPayload     # Refresh token payload
    â”‚       â”œâ”€â”€ AuthContext             # Hono context with user
    â”‚       â”œâ”€â”€ LoginResponse           # Login/register response
    â”‚       â”œâ”€â”€ RegisterInput           # Registration input
    â”‚       â””â”€â”€ LoginInput              # Login input
    â”‚
    â”œâ”€â”€ ğŸ”¨ utils/                        # Utility functions
    â”‚   â”œâ”€â”€ index.ts                     # Utils export point
    â”‚   â”‚
    â”‚   â”œâ”€â”€ jwt.ts                       # JWT utilities
    â”‚   â”‚   â””â”€â”€ JWTService
    â”‚   â”‚       â”œâ”€â”€ generateAccessToken()    # Create access token
    â”‚   â”‚       â”œâ”€â”€ generateRefreshToken()   # Create refresh token
    â”‚   â”‚       â”œâ”€â”€ verifyAccessToken()      # Verify access token
    â”‚   â”‚       â”œâ”€â”€ verifyRefreshToken()     # Verify refresh token
    â”‚   â”‚       â””â”€â”€ decodeToken()            # Decode without verify
    â”‚   â”‚
    â”‚   â””â”€â”€ validators.ts                # Zod validation schemas
    â”‚       â”œâ”€â”€ passwordSchema           # Password requirements
    â”‚       â”œâ”€â”€ emailSchema              # Email validation
    â”‚       â”œâ”€â”€ usernameSchema           # Username validation
    â”‚       â”œâ”€â”€ registerSchema           # Registration validation
    â”‚       â”œâ”€â”€ loginSchema              # Login validation
    â”‚       â””â”€â”€ refreshTokenSchema       # Refresh token validation
    â”‚
    â””â”€â”€ index.ts                         # Main application entry point
        â”œâ”€â”€ Initialize database
        â”œâ”€â”€ Setup global middlewares
        â”œâ”€â”€ Register routes
        â”œâ”€â”€ Error handlers
        â””â”€â”€ Start server


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š PROJECT STATISTICS:

Total Files: 30+
Lines of Code: ~2000+
Languages: TypeScript (100%)
Runtime: Bun
Framework: Hono
Database: PostgreSQL
ORM: TypeORM

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”’ SECURITY FEATURES:

âœ… JWT Authentication (HS256, explicit algorithm)
âœ… Bcrypt Password Hashing (12 rounds)
âœ… Rate Limiting (IP-based, configurable)
âœ… Security Headers (CSP, HSTS, X-Frame-Options, etc)
âœ… CORS Protection (whitelist-based)
âœ… Input Sanitization (XSS prevention)
âœ… IP Filtering (blacklist/whitelist)
âœ… Account Locking (brute force protection)
âœ… SQL Injection Protection (TypeORM parameterized queries)
âœ… Environment Validation (Zod schemas)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¡ API ENDPOINTS:

PUBLIC:
  GET    /health
  POST   /api/v1/auth/register
  POST   /api/v1/auth/login
  POST   /api/v1/auth/refresh-token
  POST   /api/v1/auth/logout

PROTECTED (requires Bearer token):
  GET    /api/v1/auth/me

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ—„ï¸ DATABASE TABLES:

1. users
   - User accounts with secure password storage
   - Login attempt tracking & account locking
   - Email/username uniqueness
   - Indexes on email & username

2. refresh_tokens
   - Refresh token storage with metadata
   - Token revocation support
   - IP & user agent tracking
   - Foreign key to users table

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“š DOCUMENTATION:

1. README.md              - Main documentation & API reference
2. QUICKSTART.md          - Quick setup guide (5 minutes)
3. SECURITY.md            - Security best practices & guidelines
4. REFACTORING_SUMMARY.md - Middleware refactoring details
5. PROJECT_SUMMARY.md     - Complete project overview
6. middlewares/README.md  - Middleware documentation & usage

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸš€ QUICK START:

1. Install dependencies:     bun install
2. Setup database:           createdb auth_db
3. Configure .env:           cp .env.example .env (then edit)
4. Run migrations:           bun run migration:run
5. Start server:             bun run dev

Server will run on: http://localhost:3001

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
